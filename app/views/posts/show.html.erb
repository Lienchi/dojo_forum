<h1><%= @post.title %></h1>

<% if @post.collected?(current_user) %>
  <%= link_to 'Uncollect', uncollect_post_path(@post), method: :post, class: "btn btn-info" %>
<% else %>
  <%= link_to 'Collect', collect_post_path(@post), method: :post, class: "btn btn-primary" %>
<% end %>

<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1">

      <div class="page-header">

        <div class="col-md-3 col-sm-4">
          <div class="text-center">
            <%= image_tag @post.user.avatar.url, class: "img-responsive img-rounded" %>
          </div>
        </div>

        <div class="col-md-9 col-sm-8">
          <h2><%= @post.user.name %></h2>
          <% if @post.user != current_user %>
            <% if current_user.inviting?(@post.user) %>
              <%= link_to 'Inviting ...', class: "btn btn-primary" %>
            <% elsif current_user.friend?(@post.user) %>
              <%= link_to 'Friend', class: "btn btn-primary" %>
            <% else %>
              <%= link_to 'Add Friend', friendships_path(friend_id: @post.user), method: :post, class: "btn btn-primary" %>
            <% end %>
          <% end %>
        </div>
        <div class="clearfix"></div>

      </div>

      <br>

    </div>
  </div>
</div>

Content: <%= @post.content %><br>

<br>

<% if @post.user == current_user %>
  <%= link_to 'Edit', edit_post_path(@post) %><br>
  <%= link_to 'Delete', post_path(@post), method: :delete, :data => {confirm:"Are you sure?"} %><br>
<% else %>
  Edit<br>
  Delete<br>
<% end %>

<br>

<h3>Comments</h3>

<% @comments.each do |comment| %>
  <h5>
    <%= comment.user.name %>
    <%= time_ago_in_words(comment.created_at) %> ago
  </h5>
  <p><%= comment.content %></p>
  <% if current_user.admin? || current_user == comment.user %>
    <%= link_to 'Edit', edit_post_comment_path(@post, comment) %><br>
    <%= link_to "Delete", post_comment_path(@post, comment), method: :delete, :data => {confirm:"Are you sure?"} %>
  <% end %>
<% end %>

<div class="text-center">
  <%= paginate @comments %>
</div>

<div class="container">
  <div class="row">
   <%= form_for [@post, @comment] do |f| %>
    <div class="form-group">
      <%= f.text_area :content, placeholder: "留下評論吧", class: "form-control" %>
    </div>
    <div class="form-group">
      <%= f.submit class: "btn btn-primary" %>
      <%= f.button "Cancel", type: :reset, class: "btn btn-default" %>
    </div>
  <% end %>
  </div>
</div>

<br>

<%= link_to 'Back to index', root_path %>